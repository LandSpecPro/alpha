<div class="table-header header-color-green2">
	<%= @locations.count + @otherlocations.count %> Locations Found
</div>

<table id="table_report" class="table table-striped table-bordered table-hover">
	<thead>
		<tr>
			<th class="hidden">Weight</th>
			<th class="center hidden-phone">Logo</th>
			<th class="center">Company</th>
			<th class="center">Address</th>
			<th class="center">Distance Away (miles)</th>
			<th class="center">Favorite</th>
		</tr>
	</thead>
							
	<tbody>

		<% @locations.order('updated_at DESC').each do |l| %>
		
			<tr>
				<td class="hidden">
					100
				</td>
				<td class="center hidden-phone">
					<a href="<%= locations_view_url(:id => l.id) %>" title="View Profile">
						<%= image_tag l.bus_vendor.logo.url(:smthumb), :title => "View Profile", :width => '50px', :height => '50px' %>
					</a>
				</td>
				<td class="center">
					<a href="<%= locations_view_url(:id => l.id) %>" title="View Profile">
						<%= BusVendor.find(l.bus_vendor_id).busName %>
					</a>
				</td>
				<td class='center'>
					<%= link_to l.get_full_address, get_map_link_from_address(concat_address(l)), :target => "_blank", :title => "View on Map" %>
				</td>
				<td class='center'>
					<%= "%8.1f" % l.distance_from(@setlocation) %>
				</td>
				<td class="center">
					<% if l.is_favorited(current_user) %>
						<a title="Remove From Favorites" href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark" id="fav_icon"></i></a>
					<% else %>
						<a title="Add To Favorites" href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark-empty" id="fav_icon"></i></a>
					<% end %>
				</td>
			</tr>

		<% end %>				

		<% @otherlocations.order('"bus_name" ASC').each do |ol| %>
			<tr>
				<td class="hidden">
					0
				</td>
				<td class="center hidden-phone">
				</td>
				<td class="center">
					<a data-toggle="modal" href="<%= '#' + ol.id.to_s + 'locationInfoPopupUnclaimed' %>" title="View Location Information">
						<%= ol.bus_name %>
					</a>
				</td>
				<td class='center'>
					<%= link_to ol.get_full_address, get_map_link_from_address(concat_unclaimed_address(ol)), :target => "_blank", :title => "View on Map" %>
				</td>
				<td class='center'>
					<%= "%8.1f" % ol.distance_from(@setlocation) %>
				</td>
				<td class="center">
				</td>
			</tr>

			<!-- LOCATION INFO POPUP MODAL -->

			<div id="<%= ol.id.to_s + 'locationInfoPopupUnclaimed' %>" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
				
				<div class="modal-header header-color-green2">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h3 style="color:#fff;"><%= ol.bus_name %></h3>
				</div>

				<div class="modal-body">
					<div class="profile-user-info profile-user-info-striped">

						<div class="profile-info-row">
							<div class="profile-info-name"> Email </div>

							<div class="profile-info-value">
								<span id="primaryEmail"><%= ol.user_email %></span>
							</div>
						</div>

						<div class="profile-info-row">
							<div class="profile-info-name"> Phone </div>

							<div class="profile-info-value">
								<span id="primaryEmail"><%= ol.loc_phone %></span>
							</div>
						</div>
						<% unless ol.loc_website.blank? %>
							<div class="profile-info-row">
								<div class="profile-info-name"> Website </div>

								<div class="profile-info-value">
									<span id="primaryEmail">
										<a href="<%= ol.loc_website %>" target="_blank">
											<%= ol.loc_website %>
										</a>
									</span>
								</div>
							</div>
						<% end %>

					</div>
				</div>

			</div>

		<% end %>

	</tbody>

</table>


<script type="text/javascript">

	$('#table_report').dataTable( {
		"aoColumns": [
			{"bSortable": false, "bSearchable": false},
			{"bSortable": false, "bSearchable": false},
			{"bSortable": true},
			{"bSortable": true},
			{"bSortable": true, "sType": "numeric", "bSearchable": false, "sDefaultContent": "?"},
			{"bSortable": false, "bSearchable": false}
		],
		"aaSortingFixed": [[0,'desc']],
		"bProcessing": true
	});

</script>