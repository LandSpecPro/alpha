<%- title "Manage Locations | LandSpec Pro" %>
<%= render 'layouts/sidebar' %>

	<% if @user.bus_vendor.locations.count == 0 %>
		<h4 class="center">You have no locations yet! You'll need to add some if you want to be visible to other suppliers and buyers.</h4>

	<% else %>

		<div class="row-fluid">
			<div class="span8 offset2">

				<table id="table_report" class="table table-striped table-bordered table-hover">

					<thead>
						<tr>
							<th class="center">Location Name</th>
							<th class="center">Address</th>
							<th class="center hidden-phone">Public URL</th>
							<th class="center"></th>
							<th class="center">Active?</th>
						</tr>
					</thead>
											
					<tbody>
						<% @user.bus_vendor.locations.each do |l| %>

							<tr>

								<td class="center">
									<%= l.locName  %>
								</td>

								<td class="center">
									<%=
										unless l.address2.blank?
											l.address1 + " " + l.address2 + ", " + l.city + ", " + l.state + " " + l.zip 
										else
											l.address1 + ", " + l.city + ", " + l.state + " " + l.zip 
										end
									%>
								</td>

								<td class="center hidden-phone">
									<% if l.public_url_active %>
										<a href="http://www.landspecpro.com/profiles/<%= l.public_url %>" target="_blank">
											<%= l.public_url %>
										</a>
									<% else %>
										<a href="http://www.landspecpro.com/profiles/<%= l.public_url %>" target="_blank" data-rel="popover" data-placement="top" data-trigger="hover" data-content="This Profile is still active, but you have not set a custom URL. You can do this from the Edit Location page.">
											temp
										</a>
									<% end %>
								</td>

								<td class="center">
									<a href=<%= locations_view_url(:id => l.id) %> title="View">
										<span class="btn btn-mini btn-warning"><i class="icon-eye-open"></i> View</span>
									</a>
									<a href=<%= 'edit/' + l.id.to_s %> title="Edit">
										<span class="btn btn-mini btn-info"><i class="icon-edit"></i> Edit</span>
									</a>
									<a href=<%= locations_delete_url(:id => l.id) %> title="Delete" class="hide">
										<span class="btn btn-mini btn-danger"><i class="icon-trash"></i> Delete</span>
									</a>
								</td>

								<td class="center">
									<% if l.active %>
										<span class="badge badge-success" data-rel="popover" data-content="Active!" data-placement="top" data-trigger="hover"><i class="icon-ok"></i></span>
									<% else %>
										<span class="badge badge-important" data-rel="popover" data-content="Inactive! Contact us if you think this is in error." data-placement="top" data-trigger="hover"><i class="icon-remove"></i></a>
									<% end %>
								</td>

							</tr>

						<% end %>
					</tbody>

				</table>

			</div>
		</div>

	<% end %>

	<br/>
	
	<div class="center">
		<a class="btn btn-large btn-success" href="<%= locations_new_url %>">Add New Location</a>
	</div>

<%= render 'layouts/sidebarend' %>

<script type="text/javascript">

	$(applyPopovers());

	$('#table_report').dataTable( {
		"aoColumns": [
			{"bSortable": true, "bSearchable": true},
			{"bSortable": true, "bSearchable": true},
			{"bSortable": true, "bSearchable": true},
			{"bSortable": false, "bSearchable": false},
			{"bSortable": true, "bSearchable": false}
		],
		"bFilter": true,
		"bPaginate": false
	});

</script>