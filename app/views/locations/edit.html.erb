<%= render 'layouts/sidebar' %>

	<div class="row-fluid">
		<div class="span4 offset1">
			<%= form_for @location, :html => {:id => 'form_location_address'} do |f| %>
				<div class="widget-box">
					<div class="widget-header header-color-blue">
						<h5 class="bigger lighter"><i class="icon-globe"></i> Location Address</h5>
						<div class="widget-toolbar">
							<a href="javascript:{return true;}" onclick="document.getElementById('form_location_address').submit();" class="white" id="white-link"><i  class="icon-save" id="fav_icon"></i> Update</a>
						</div>
					</div>

					<div class="widget-body">

						<div class="widget-main">

							<!-- Display error messages as alerts -->
							<% @location.errors.full_messages.each do |msg| %>
								<div class="alert alert-error">
								  <button type="button" class="close" data-dismiss="alert">&times;</button>
								  <strong>Error! </strong> <%= msg %>
								</div>
							<% end %>

							<fieldset>

								<%= f.hidden_field :id, :value => @location.id %>

								Location Name: 
								<div class="block input-icon input-icon-right">
									<%= f.text_field :locName, :class => 'span12', :value => @location.locName %>
								</div>

								Street 1:
								<div class="block input-icon input-icon-right">
									<%= f.text_field :address1, :class => 'span12', :value => @location.address1 %>
								</div>

								Street 2:
								<span class="block input-icon input-icon-right">
									<%= f.text_field :address2, :class => 'span12', :value => @location.address2 %>
								</span>

								City:
								<span class="block input-icon input-icon-right">
									<%= f.text_field :city, :class => 'span12', :value => @location.city %>
								</span>

								<div class="row-fluid">
									<div class="span6">
										State:
										<span class="block input-icon input-icon-right">
											<%= f.select(:state, get_states, {}, {:class => 'span12 chzn-select'}) %>
										</span>
									</div>
									<div class="span6">
										Zip Code:
										<span class="block input-icon input-icon-right">
											<%= f.text_field :zip, :class => 'span12', :value => @location.zip %>
										</span>	
									</div>
								</div>

							</fieldset>

						</div>

					</div>
				</div>
			<% end %>
		</div>
	</div>

	<div class="row-fluid">
		<div class="span4 offset1">
			<%= form_for @location, :html => {:id => 'form_location_info'} do |f| %>
				<div class="widget-box">
					<div class="widget-header header-color-blue">
						<h5 class="bigger lighter"><i class="icon-globe"></i> Location Info</h5>
						<div class="widget-toolbar">
							<a href="javascript:{return true;}" onclick="document.getElementById('form_location_info').submit();" class="white" id="white-link"><i  class="icon-save" id="fav_icon"></i> Update</a>
						</div>
					</div>

					<div class="widget-body">

						<div class="widget-main">

							<!-- Display error messages as alerts -->
							<% @location.errors.full_messages.each do |msg| %>
								<div class="alert alert-error">
								  <button type="button" class="close" data-dismiss="alert">&times;</button>
								  <strong>Error! </strong> <%= msg %>
								</div>
							<% end %>

							<fieldset>

								<%= f.hidden_field :id, :value => @location.id %>

								Primary Phone: 
								<div class="block input-icon input-icon-right">
									<%= f.text_field :primaryPhone, :class => 'span12', :value => @location.primaryPhone %>
								</div>

								Secondary Phone:
								<div class="block input-icon input-icon-right">
									<%= f.text_field :secondaryPhone, :class => 'span12', :value => @location.secondaryPhone %>
								</div>

								Fax:
								<span class="block input-icon input-icon-right">
									<%= f.text_field :fax, :class => 'span12', :value => @location.fax %>
								</span>

								Primary Email:
								<span class="block input-icon input-icon-right">
									<%= f.text_field :primaryEmail, :class => 'span12', :value => @location.primaryEmail %>
								</span>

								Secondary Email:
								<span class="block input-icon input-icon-right">
									<%= f.text_field :secondaryEmail, :class => 'span12', :value => @location.secondaryEmail %>
								</span>

								<div class="row-fluid">
									<div class="span6">
										Website:
										<span class="block input-icon input-icon-right">
											<%= f.text_field :websiteLink, :class => 'span12', :value => @location.websiteLink %>
										</span>	
									</div>
									<div class="span6">
										Facebook Link:
										<span class="block input-icon input-icon-right">
											<%= f.text_field :facebookLink, :class => 'span12', :value => @location.facebookLink %>
										</span>	
									</div>	

								</div>		
								<div class="row-fluid">
									<div class="span6">
										Twitter Link:
										<span class="block input-icon input-icon-right">
											<%= f.text_field :twitterLink, :class => 'span12', :value => @location.twitterLink %>
										</span>	
									</div>
									<div class="span6">
										Google+:
										<span class="block input-icon input-icon-right">
											<%= f.text_field :googleLink, :class => 'span12', :value => @location.googleLink %>
										</span>
									</div>
								</div>	

							</fieldset>

						</div>

					</div>
				</div>
			<% end %>
		</div>
	</div>

	<div class="row-fluid">

		<div class="span4 offset1">

			<%= render 'formaddfeatureditem' %>

		</div>

		<div class="row-fluid">
			<div class="span10 offset1">

				<% if @location.featured_items.count != 0 %>
					<div class="row-fluid">
						<h1>Featured Items:</h1>
						<% @location.featured_items.each do |fi| %>

							
							<div class="span3">
								<div class="widget-box">
									<div class="widget-header header-color-blue">
										<h5 class="bigger lighter"><i class="icon-star"></i> <%= fi.get_product.commonName %></h5>
										<div class="widget-toolbar">
											<a href='#' title="Update">
												<span class="badge badge-success"><i class="icon-save"></i></span>
											</a>
											<a href=<%= locations_featureditem_delete_url(:featured_item_id => fi.id, :location_id => fi.location_id) %> title="Delete">
												<span title='Delete' class="badge badge-important"><i class="icon-trash"></i></span>
											</a>
										</div>
									</div>
									<div class="widget-body">

										<div class="widget-main">
											<div class="center">
												<%= image_tag fi.get_image.url(:thumb) %>
											</div>
											<div>
												<h4>Description:</h4>
												<%= fi.description %>
											</div>
										</div>

									</div>

									

								</div>
							</div>


							

						<% end %>
					</div>
				<% end %>
			</div>
		</div>

	</div>

<%= render 'layouts/sidebarend' %>

<script type="text/javascript">

	$(document).ready(chosenf())

	function chosenf(){
	  $(".chzn-select").chosen();

	  bindInput();
	  fileInput();
	}

	function bindInput(){
		$('#productSelect').change(function(){
			if($(this).val() != 'New Product'){

				//var p = document.getElementById("productSelect");
				//var common_name = p.options[p.selectedIndex].dataset["comname"];
				//var latin_name = p.options[p.selectedIndex].dataset["latname"];

				$('#commonName').val($(this).val());
				$('#commonName').attr('readonly', true);
			}
			else{
				$('#commonName').val('');
				$('#commonName').attr('readonly', false);
				$(this).blur();
				$('#commonName').focus();
			}
		})
	}

	function fileInput(){
		$('#image').ace_file_input({
				no_file:'No File ...',
				btn_choose:'Choose',
				droppable:false,
				onchange:null,
				thumbnail:false
			}).on('change', function(){
				//$(this).text($(this).data('ace_input_files'));
			    //console.log($(this).data('ace_input_files'));
			    //console.log($(this).data('ace_input_method'));
			});
	}

</script>