<%- title "Favorite Suppliers | LandSpec Pro" %>
<%= render 'layouts/sidebar' %>

<style>
	#supplier-logo{

	}
</style>
	<!--[if lt IE 10]> <div style="font-size:15px;"><![endif]-->
<div class="row">
	<div class="col-md-10 col-md-offset-1">
		<div class="table-header header-color-green2">
			You have <%= @favlocations.count + @favlocationsinactive.count %> Favorite Suppliers
		</div>

		<div class="table-responsive">
			<table id="table_report" class="table table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th class="center hidden-480">Logo</th>
						<th class="center">Company</th>
						<th class="center">Address</th>
						<th class="center">Distance Away (miles)</th>
						<th class="center hidden-480">Favorite</th>
					</tr>
				</thead>
										
				<tbody>

					<% @favlocations.each do |l| %>

						<% l = l.location %>
					
						<tr>
							<td class="center hidden-480">
								<a href="<%= locations_view_url(:id => l.id) %>" title="<%= l.busName %>">
									<%= image_tag l.bus_vendor.logo.url(:thumb), :title => l.busName, :style => 'max-height:50px; max-width:100%; display:block; margins:auto;' %>
								</a>
							</td>
							<td class="center">
								<a href=<%= locations_view_url(:id => l.id) %> title="View Profile">
									<%= l.busName %>
								</a>
							</td>
							<td class='center'>
								<%= link_to l.get_full_address, get_map_link_from_address(concat_address(l)), :target => "_blank", :title => "View on Map" %>
							</td>
							<td class='center'>
								<%= "%8.1f" % l.distance_from(current_user.currentCity + ", " + current_user.currentState) %>
							</td>
							<td class="center hidden-480">
								<% if l.is_favorited(current_user) %>
									<a title="Remove from favorites" href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark" id="fav_icon"></i></a>
								<% else %>
									<a title="Add to favorites"  href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark-empty" id="fav_icon"></i></a>
								<% end %>
							</td>
						</tr>

					<% end %>

					<% @favlocationsinactive.each do |l| %>

						<% if l.location %>

							<% l = l.location %>

							<tr>
								<td class="center hidden-480">
									<%= image_tag l.bus_vendor.logo.url(:smthumb), :title => l.busName, :style => 'max-height:100%; max-width:100%; display:block; margins:auto;', :id => 'supplier-logo' %>
								</td>
								<td class="center">
									<span data-rel="popover" data-content="This location is no longer active." data-placement="top" data-trigger="hover">
										<%= l.busName %>
									</span>
								</td>
								<td class="center">
									<%= link_to l.get_full_address, get_map_link_from_address(concat_address(l)), :target => "_blank", :title => "View on Map" %>
								</td>
								<td class="center">
									<%= "%8.1f" % l.distance_from(current_user.currentCity + ", " + current_user.currentState) %>
								</td>
								<td class="center hidden-480">
									<% if l.is_favorited(current_user) %>
										<a title="Remove from favorites" href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark" id="fav_icon"></i></a>
									<% else %>
										<a title="Add to favorites"  href=<%= locations_favorite_set_url(:id => l.id) %>><i  class="icon-bookmark-empty" id="fav_icon"></i></a>
									<% end %>
								</td>
							</tr>

						<% end %>

					<% end %>

				</tbody>

			</table>
		</div>
	</div>
</div>
	<!--[if lt IE 10]> </div><![endif]-->
<%= render 'layouts/sidebarend' %>

<script type="text/javascript">

	$(applyPopovers());

	$('#table_report').dataTable( {
		"aoColumns": [
			{"bSortable": false, "bSearchable": false},
			{"bSortable": true},
			{"bSortable": true},
			{"bSortable": true, "sType": "numeric", "bSearchable": false, "sDefaultContent": "?"},
			{"bSortable": false, "bSearchable": false}
		]
	});

</script>