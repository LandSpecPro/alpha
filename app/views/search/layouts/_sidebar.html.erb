<div class="widget-box">

	<div class="widget-header header-color-green2">
		<h5 class="lighter">Search Bar</h5>
	</div>

	<div class="widget-body">
		<div class="widget-main">

			<%= form_tag @path, :method => 'get' do %>

				<%= hidden_field_tag :search_type, controller.action_name %>
				<%= hidden_field_tag :sort, params[:sort] %>
				<%= hidden_field_tag :per_page, params[:per_page] %>

				<!-- Search Box 
						- Need to change to CHZN dropdown and set up with another render so that a different box is rendered
						  depending on if this is the supplier or product search.
				-->

				<div class="row-fluid">
					<div class="span8">
						<% if controller.action_name == 'supplier' %>
							<%= render 'search/layouts/supplier_search_box' %>
						<% elsif controller.action_name == 'product' %>
							<%= render 'search/layouts/product_search_box' %>
						<% end %>
					</div>
					<div class="span4">
						<%= submit_tag "Search", :class => "btn btn-success btn-small btn-block" %>
					</div>
				</div>

				<br/>

				<div class="row-fluid">
					<div class="span12 center">
						<% if params[:current_location] %>
							<input class="ace" type="checkbox" id="current_location" name="current_location" checked>
						<% else %>
							<input class="ace" type="checkbox" id="current_location" name="current_location">
						<% end %>
						<label class="lbl" for="current_location" data-rel="popover" data-placement="right" data-container="body" data-trigger="hover" data-content="Selecting this will use geolocation to determine an approximate location to use for searching. To search more precisely, or to search in a different area, just type in an address or city below." data-title="Search by Location"> Use My Location</label>
					</div>
				</div>
			<% if params[:current_location] %>
				<div class="row-fluid hide" id="setLocationRow">
			<% else %>
				<div class="row-fluid" id="setLocationRow">
			<% end %>
					<div class="span12 center">
						<input id='location' name='location' type='text' class='input span10 center' placeholder="Location to search from..." value="<%= params[:location] %>" />
					</div>
				</div>

				<div class="row-fluid">
					<div class="span12 center">

						<label class="lbl" for="distance_from">Max Miles Away:</label>
					<% if params[:distance_from].blank? or params[:distance_from].to_i > 9000 %>
						<input id='distance_from' name='distance_from' type='text' class='input span10 center' placeholder="Leave blank to search any distance..." />
					<% else %>
						<input id='distance_from' name='distance_from' type='text' class='input span10 center' value="<%= params[:distance_from] %>" />
					<% end %>

					</div>
				</div>

				<br/>

				

			<% end %>

		</div>
		<div class="widget-footer">
			<div class="row-fluid">
				<div class="span12 center">
					<% if controller.action_name == 'product' and params[:view] == 'list' %>
						<a href="<%= change_view_url('product', 'grid') %>" class="btn btn-success btn-block btn-small">Switch to Grid View</a>
					<% elsif controller.action_name == 'product' and params[:view] == 'grid' %>
						<a href="<%= change_view_url('product', 'list') %>" class="btn btn-success btn-block btn-small">Switch to List View</a>
					<% elsif controller.action_name == 'supplier' and params[:view] == 'list' %>
						<a href="<%= change_view_url('supplier', 'map') %>" class="btn btn-success btn-block btn-small">Switch to Map View</a>
					<% elsif controller.action_name == 'supplier' and params[:view] == 'map' %>
						<a href="<%= change_view_url('supplier', 'list') %>" class="btn btn-success btn-block btn-small">Switch to List View</a>
					<% end %>
				</div>
			</div>
		</div>
	</div>

</div>

<script type="text/javascript">

	$('#current_location').change(function(){
		if(document.getElementById('current_location').checked){
			$('#setLocationRow').addClass('hide');
		}	
		else{
			$('#setLocationRow').removeClass('hide');
		}
	});


</script>